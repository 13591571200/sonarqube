<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.sonar.core.log.db.LogMapper">
    <insert id="insert" parameterType="Log" useGeneratedKeys="false">
        insert into logs
        (payload_field, created_at,execution_time_field,user_login,data_field)
        values (#{payload}, #{time}, #{executionTime}, #{author}, #{data})
    </insert>

    <select id="selectByKey" parameterType="map" resultType="Log">
      SELECT
        l.payload_field as "payload",
        l.created_at as "time",
        l.execution_time_field as "executionTime",
        l.user_login as "author",
        l.data_field as "data"
      FROM logs l
      WHERE l.time_field=#{key.time}
        AND l.payload_field=#{key.payload}
        AND l.author_field=#{key.author}

    </select>
</mapper>

