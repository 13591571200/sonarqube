<% if measure(Metric::LINES) %>
<table width="100%">
  <tr>
    <td valign="top" width="50%">
		  <div class="dashbox">
		    <h3>Violations</h3>
			  <div class="big marginbottom10">
			    <%= format_measure(Metric::VIOLATIONS, :url => url_for(:controller => 'drilldown', :action => 'violations', :id => @project.key)) -%> <%= trend_icon(Metric::VIOLATIONS) -%>
			  </div>
        <h3>Rules compliance</h3>
        <div class="big">
          <%= format_measure(Metric::VIOLATIONS_DENSITY, :url => url_for_drilldown(Metric::WEIGHTED_VIOLATIONS, {:highlight => Metric::WEIGHTED_VIOLATIONS})) -%> <%= trend_icon(Metric::VIOLATIONS_DENSITY) -%>
        </div>
		  </div>
	 	</td>
		<td valign="top" width="50%" nowrap>
			<%
			blocker_violations = @snapshot.measure(Metric::BLOCKER_VIOLATIONS)
			critical_violations = @snapshot.measure(Metric::CRITICAL_VIOLATIONS)
			major_violations = @snapshot.measure(Metric::MAJOR_VIOLATIONS)
			minor_violations = @snapshot.measure(Metric::MINOR_VIOLATIONS)
			info_violations = @snapshot.measure(Metric::INFO_VIOLATIONS)
			max = 0
			[blocker_violations,critical_violations,major_violations,minor_violations,info_violations].each do |m|
				max = m.value if m and m.value and m.value>max
			end
			%>
			    <table class="clear width100">
			      <tr>
			        <td><%= image_tag 'priority/BLOCKER.png'%></td>
			        <td> &nbsp;<%= link_to 'Blocker', {:controller => 'drilldown', :action => 'violations', :id => @project.key, :priority => 'BLOCKER'} %></td>
			        <td style="padding-left: 10px;" align="right">
			          <%= format_measure(blocker_violations) -%>
			        </td>
			        <td width="1%"><%= trend_icon(blocker_violations) -%></td>
			        <td align="left" style="padding-bottom:2px; padding-top:2px;">
			         <%= barchart(:width => 60, :percent => (blocker_violations ? (100 * blocker_violations.value / max).to_i : 0), :color => '#777777') if max>0 %>
			        </td>
			      </tr>
			      <tr>
			        <td><%= image_tag 'priority/CRITICAL.png'  %></td>
			        <td> &nbsp;<%= link_to 'Critical', {:controller => 'drilldown', :action => 'violations', :id => @project.key, :priority => 'CRITICAL'} %></td>
			        <td style="padding-left: 10px;" align="right">
			            <%= format_measure(critical_violations) -%>
			        </td>
			        <td width="1%"><%= trend_icon(critical_violations) -%></td>
			        <td align="left" style="padding-bottom:2px; padding-top:2px;">
			          <%= barchart(:width => 60, :percent => (critical_violations ? (100 * critical_violations.value / max).to_i : 0), :color => '#777777') if max>0 %>
			        </td>
			      </tr>
			      <tr>
			      <td><%= image_tag 'priority/MAJOR.png'  %></td>
			        <td> &nbsp;<%= link_to 'Major', {:controller => 'drilldown', :action => 'violations', :id => @project.key, :priority => 'MAJOR'} %></td>
			        <td style="padding-left: 10px;" align="right">
			          <%= format_measure(major_violations) -%>
			       </td>
			       <td width="1%"><%= trend_icon(major_violations) -%></td>
			       <td align="left" style="padding-bottom:2px; padding-top:2px;">
			          <%= barchart(:width => 60, :percent => (major_violations ? (100 * major_violations.value / max).to_i : 0), :color => '#777777') if max>0 %>
			        </td>
			      </tr>
			      <tr>
			      <td><%= image_tag 'priority/MINOR.png'  %></td>
			        <td> &nbsp;<%= link_to 'Minor', {:controller => 'drilldown', :action => 'violations', :id => @project.key, :priority => 'MINOR'} %></td>
			        <td style="padding-left: 10px;" align="right">
			            <%= format_measure(minor_violations) -%>
			       </td>
			       <td width="1%"><%= trend_icon(minor_violations) -%></td>
			       <td align="left" style="padding-bottom:2px; padding-top:2px;">
			          <%= barchart(:width => 60, :percent => (minor_violations ? (100 * minor_violations.value / max).to_i : 0), :color => '#777777') if max>0 %>
			        </td>
			      </tr>
			      <tr>
			      <td><%= image_tag 'priority/INFO.png'  %></td>
			        <td> &nbsp;<%= link_to 'Info', {:controller => 'drilldown', :action => 'violations', :id => @project.key, :priority => 'INFO'} %></td>
			        <td style="padding-left: 10px;" align="right">
					      <%= format_measure(info_violations) -%>
			       </td>
			       <td width="1%"><%= trend_icon(info_violations) -%></td>
			       <td align="left" style="padding-bottom:2px; padding-top:2px;">
			          <%= barchart(:width => 60, :percent => (info_violations ? (100 * info_violations.value / max).to_i : 0), :color => '#777777') if max>0 %>
			        </td>
			      </tr>
			    </table>
	    </td>
	  </tr>
    </table>
<% end %>