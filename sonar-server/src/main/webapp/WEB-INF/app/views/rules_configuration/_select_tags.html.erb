<% #locals = rule, tags, profile_id -%>
<div class="modal-head">
  <h2><%= message('rules_configuration.select_tags_for_rule') -%> <%= h rule.name -%></h2>
</div>

<form onsubmit="$j.ajax({
                        url:'<%=ApplicationController.root_context-%>/rules_configuration/create_tag',
                        success:function(response){ $j('#select-rule-tags').html(response); },
                        error:function(response){ $j('#select-tags-error').html(response); },
                        data: $j(this).serialize(),
                        type:'post'});
                  return false;"
        method="post"
        action="<%=ApplicationController.root_context-%>/rules_configuration/create_tag">
  <%= hidden_field_tag :rule_id, rule.id -%>
  <fieldset>
    <div class="modal-body">
      <%= text_field_tag 'new_tag', '', :size => 20, :maxlength => 20, :placeholder => message('rules_configuration.new_tag') -%>
      <%= submit_tag message('rules_configuration.create_tag'), { :id => 'create_tag' } -%>
    </div>
  </fieldset>
</form>

<form onsubmit="$j.ajax({
                        url:'<%=ApplicationController.root_context-%>/rules_configuration/select_tags',
                        success:function(response){ closeModalWindow();$j('#rule_tags_<%=rule.id-%>').html(response); },
                        error:function(response){ $j('#select-tags-error').html(response); },
                        data: $j(this).serialize(),
                        type:'post'});
                  return false;"
        method="post"
        action="<%=ApplicationController.root_context-%>/rules_configuration/select_tags">
  <%= hidden_field_tag :rule_id, rule.id -%>
  <%= hidden_field_tag :profile_id, profile_id -%>
  <fieldset>
    <div class="modal-body">
      <div class="modal-error" id="select-tags-error"/>
      <div id="select-rule-tags" style="height: 200px; overflow-y: visible">
        <%= render :partial => 'select_tags_list', :locals => { :tags => tags } -%>
      </div>
    </div>

    <div class="modal-foot">
      <%= submit_tag message('rules_configuration.update_tags'), { :id => 'update_tags_' + rule.id.to_s } -%>
      <a href="#" onclick="return closeModalWindow()" id="confirm-cancel"><%= h message('cancel') -%></a>
    </div>
  </fieldset>
</form>
