<% #locals = rule, tags, profile_id -%>
<form onsubmit="$j.ajax({
                        url:'<%=ApplicationController.root_context-%>/rules_configuration/select_tags',
                        success:function(response){ closeModalWindow();$j('#rule_tags_<%=rule.id-%>').html(response); },
                        error:function(response){ $j('#select-tags-error').html(response); },
                        data: $j(this).serialize(),
                        type:'post'});
                  return false;"
        method="post"
        action="<%=ApplicationController.root_context-%>/rules_configuration/select_tags">
  <%= hidden_field_tag :rule_id, rule.id -%>
  <%= hidden_field_tag :profile_id, profile_id -%>
  <fieldset>
    <div class="modal-head">
      <h2>Select Tags for Rule: <%= h rule.name -%></h2><%# TODO i18n?-%>
    </div>

    <div class="modal-body">
      <div class="modal-error" id="select-tags-error"/>
      <div id="select-rule-tags" style="height: 200px; overflow-y: visible">
        <ul>
        <% tags.each do |tag| -%>
          <li style="padding: 5px 2px">
            <%= check_box_tag 'tags[]', tag[:value], tag[:selected], :id => 'tags_'+tag[:value], :disabled => tag[:read_only] -%>
            <label for="tags_<%= tag[:value] -%>"><%= tag[:value] -%></label>
          </li>
        <% end -%>
        </ul>
      </div>
    </div>

    <div class="modal-foot">
      <%= submit_tag message('Update Tags'), { :id => 'update_tags_' + rule.id.to_s } -%>
      <a href="#" onclick="return closeModalWindow()" id="confirm-cancel"><%= h message('cancel') -%></a>
    </div>
  </fieldset>
</form>
