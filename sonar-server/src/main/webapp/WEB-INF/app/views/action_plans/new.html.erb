<h1 class="marginbottom10"><%= message('action_plans.create_new_action_plan') -%></h1>

<% if @action_plan && @action_plan.errors.on_base
     @action_plan.errors.on_base.each do |error| %>
  <div class="error"><%= error -%></div>
<%   end
   end
%>

<form action="<%= url_for :action => 'save' -%>" method="POST" id="createForm">
  <input type="hidden" name="id" value="<%= @resource.id -%>"/>
  <input type="hidden" name="plan_id" value="<%= @action_plan.id if @action_plan -%>"/>
  <table class="width100 form">
    <tbody>
      <tr>
        <td class="keyCell">
          <%= message('action_plans.col.name') -%>:
        </td>
        <td>
          <input type="text" name="name" id="name" value="<%= @action_plan ? @action_plan.name : '' -%>"/>
          <% if @action_plan && @action_plan.errors.on('name')
               @action_plan.errors.on('name').each do |error| %>
            <span class="error"><%= error -%></span>
          <%   end
             end %>
        </td>
      </tr>
      <tr>
        <td class="keyCell">
          <%= message('action_plans.col.due_for') -%>:
        </td>
        <td>
          <input type="text" name="dead_line" id="dead_line" value="<%= @action_plan && @action_plan.dead_line ? @action_plan.dead_line.strftime('%d/%m/%Y') : params[:dead_line] -%>"/>
          <span class="note"><%= message('action_plans.date_format_help') -%></span>
          <% if @action_plan && @action_plan.errors.on('dead_line')
               @action_plan.errors.on('dead_line').each do |error| %>
            <span class="error"><%= error -%></span>
          <%   end
             end %>
        </td>
      </tr>
      <tr>
        <td class="keyCell">
          <%= message('action_plans.col.description') -%>:
        </td>
        <td>
          <textarea rows="5" cols="80" name="description" id="description" class="width100"><%= @action_plan ? @action_plan.description : '' -%></textarea>
          <% if @action_plan && @action_plan.errors.on('description')
               @action_plan.errors.on('description').each do |error| %>
            <span class="error"><%= error -%></span>
          <%   end
             end %>
        </td>
      </tr>
      <tr>
        <td class="keyCell">
        </td>
        <td>
          <input type="submit" value="<%= message('save') -%>"/>
          <%= link_to message('cancel'), :action => 'index', :id => @resource.id -%>
        </td>
      </tr>
    </tbody>
  </table>
</form>