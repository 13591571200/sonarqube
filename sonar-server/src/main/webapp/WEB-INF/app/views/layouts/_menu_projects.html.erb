<script>
  if (supports_html5_storage()) {
    var sonarRecentHistory = new Sonar.RecentHistory();
  }
</script>

  <style>
    #recent-history-list imgs {
      float: left;
    }
  </style>

<li>
  <a href="#" onclick="if (sonarRecentHistory) { sonarRecentHistory.populateRecentHistoryPanel(); }; $j('#projects-menu').toggle(); return false;" class="link-more"><%= message('layout.projects') -%></a>
  
  <div id="projects-menu" class="dropdown-menu" style="max-width: none; display: none;" onmouseout="$j(this).hide();" onmouseover="$j(this).show();">
    <div id="recent-history">
      <h2><%= message('layout.recent_activity') -%></h2>
      <ul id="recent-history-list">
      </ul>
    </div>
    
    <div>
      <ul>
        <li><a href="<%= ApplicationController.root_context -%>/">Projects</a></li>
        <li><a href="<%= ApplicationController.root_context -%>/">Views</a></li>
        <li><a href="<%= ApplicationController.root_context -%>/">Developers</a></li>
      </ul>
    </div>
  </div>
  
</li>

<script>
  if (sonarRecentHistory == null) {
    $j('#recent-history').detach();
  } else {
    sonarRecentHistory.add('<%= @resource ? @resource.key : "" -%>', 
                           '<%= @resource ? @resource.name(true) : "" -%>', 
                           '<%= @resource ? Api::Utils.java_facade.getResourceType(@resource.qualifier).getIconPath() : "" -%>');
  }
</script>