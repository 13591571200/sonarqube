<form id="apply-template-form" method="post" action="<%= ApplicationController.root_context -%>/roles/apply_template">
  <% unless components.nil? %>
    <input type="hidden" name="components" id="apply-template-components" value="<%= components.join(',') %>"/>
  <% end %>
  <fieldset>
    <div class="modal-head">
    <% if project_name %>
      <h2><%= message('projects_role.apply_template_to_xxx', :params => project_name) -%></h2>
    <% else %>
      <h2><%= message('projects_role.apply_template') -%></h2>
    <% end %>
    </div>
    <div class="modal-body">
      <div class="modal-error"/>
      <% if components.nil? %>
        <div class="info">
          <img src="<%= ApplicationController.root_context -%>/images/information.png" style="vertical-align: text-bottom"/>
          <%= message 'projects_role.no_projects' -%>
        </div>
      <% else %>
        <div class="modal-field">
          <%= label_tag 'template_key', 'Permission Template' %>
          <%= select_tag('template_key', options_for_select(@permission_templates, -1), :style => 'width: 250px;') %>
          <% unless project_name %>
            <span style="float:right" class="note">(<%= "#{components.size} #{message('qualifier.' + qualifier)}s" %>)</span><br/>
          <% end %>
        </div>
      <% end %>
    </div>
    <div class="modal-foot">
      <% unless components.nil? %>
        <span id="apply-template-loading-image" class="loading-image hidden"><%= image_tag 'loading.gif' %></span>
        <input type="submit" value="<%= message('apply') -%>" id="apply-template-submit" class="apply-template" onclick="return displayLoadingImage()" />
      <% end %>
      <a href="#" onclick="return closeModalWindow()" id="apply-template-cancel"><%= message('cancel') -%></a>
    </div>
  </fieldset>
</form>
<script>
  $j("#apply-template-form").modalForm();

  function displayLoadingImage() {
    $j('#apply-template-loading-image').removeClass("hidden");
  }
</script>
