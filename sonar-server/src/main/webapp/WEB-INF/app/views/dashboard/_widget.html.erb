<div id="widget_<%= definition.getId().tr('_', '') -%>" class="content <%= definition.getId() %>" style="height:100%;">
<%
  begin
    widget_body=render :inline => definition.getTarget().getTemplate(), :locals => {:widget_properties => widget.properties_as_hash}
  rescue => error
     logger.error("Can not render widget #{definition.getId()}: " + error)
     logger.error(error.backtrace.join("\n"))
     widget_body=""
  end

  if widget_body.include?('<')
%>
    <%= widget_body %>
<%
  else
%>
    <p>Can not render widget <b><%= definition.getTitle() %></b>.</p>
<%
  end
%>
<div style="clear: both;"></div>
</div>