<script type="text/javascript">
  <!--
  var options = {
    editorEnabled:true,
    portal:'dashboard',
    column:'dashboard-column',
    columnhandle:'column-handle',
    block:'block',
    hoverclass:'block-hover',
    handleClass:'widget-handle',
    dashboardstate:'dashboardstate',
    toggle:'block-toggle',
    blocklist:'widget_defs',
    highlight_duration:2,
    highlight_startcolor:'#cae3f2',
    highlight_endcolor:'#ffffff',
    saveurl:'<%= url_for dashboard_action(:set_dashboard) -%>'
  };
  var portal;
  function init_dashboard() {
    portal = new Portal(options);
  <% if params[:highlight] %>
    portal.highlightWidget(<%= params[:highlight] -%>);
  <% end %>
  }
  Event.observe(window, 'load', init_dashboard, false);

  function filterWidgets(category) {
    new Ajax.Updater(
      'widget_defs',
      '<%= add_category_to_url(url_for dashboard_action(:widget_definitions))  -%>' + encodeURIComponent(category),
      {asynchronous:true, evalScripts:true});
    $('filter-widgets-loading').show();
    return false;
  }
  //-->
</script>
